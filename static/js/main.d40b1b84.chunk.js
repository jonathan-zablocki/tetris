(this["webpackJsonptetris-app"]=this["webpackJsonptetris-app"]||[]).push([[0],[,,,,,,,function(e,t,r){},,function(e,t,r){e.exports=r(18)},,,,,function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),i=r(8),o=r.n(i),s=(r(14),r(15),r(5)),c=r(1),l=r(4),u=r(3),m=r(2),v=[[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]].reverse(),[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]].reverse(),[[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]].reverse(),[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]].reverse()],d={value:"I",origin:{x:3,y:18},orient:0,cells:v[0]},f=[[[0,1,0],[1,1,1],[0,0,0]].reverse(),[[0,1,0],[0,1,1],[0,1,0]].reverse(),[[0,0,0],[1,1,1],[0,1,0]].reverse(),[[0,1,0],[1,1,0],[0,1,0]].reverse()],h={value:"T",origin:{x:3,y:19},orient:0,cells:f[0]},p=[[[0,1,1],[1,1,0],[0,0,0]].reverse(),[[0,1,0],[0,1,1],[0,0,1]].reverse(),[[0,0,0],[0,1,1],[1,1,0]].reverse(),[[1,0,0],[1,1,0],[0,1,0]].reverse()],y={value:"S",origin:{x:3,y:19},orient:0,cells:p[0]},g=[[[1,1,0],[0,1,1],[0,0,0]].reverse(),[[0,0,1],[0,1,1],[0,1,0]].reverse(),[[0,0,0],[1,1,0],[0,1,1]].reverse(),[[0,1,0],[1,1,0],[1,0,0]].reverse()],x={value:"Z",origin:{x:3,y:19},orient:0,cells:g[0]},b=[[[1,1],[1,1]].reverse(),[[1,1],[1,1]].reverse(),[[1,1],[1,1]].reverse(),[[1,1],[1,1]].reverse()],S={value:"O",origin:{x:4,y:20},orient:0,cells:b[0]},w=[[[1,0,0],[1,1,1],[0,0,0]].reverse(),[[0,1,1],[0,1,0],[0,1,0]].reverse(),[[0,0,0],[1,1,1],[0,0,1]].reverse(),[[0,1,0],[0,1,0],[1,1,0]].reverse()],O={value:"J",origin:{x:4,y:19},orient:0,cells:w[0]},k=[[[0,0,1],[1,1,1],[0,0,0]].reverse(),[[0,1,0],[0,1,0],[0,1,1]].reverse(),[[0,0,0],[1,1,1],[1,0,0]].reverse(),[[1,1,0],[0,1,0],[0,1,0]].reverse()],N={value:"L",origin:{x:4,y:19},orient:0,cells:k[0]},E={levels:[0,1,2,3,4,5,6,7,8,9,10,13,16,19,29],speeds:[800,717,633,550,467,383,300,217,133,100,83,67,50,33,17]},T=(r(7),function(e){Object(u.a)(r,e);var t=Object(m.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).componentDidMount=function(){document.addEventListener("keydown",n.props.handleKeyPress),n.drawBoard()},n.componentWillUnmount=function(){document.removeEventListener("keydown",n.props.handleKeyPress)},n.componentDidUpdate=function(){n.drawBoard()},n.drawBoard=function(){var e=n.canvasRef.current,t=e.getContext("2d"),r=n.props.board,a=n.props.tetromino;e.width=400,e.height=800;for(var i=0;i<20;i++)for(var o=0;o<10;o++)C(t,{x:o,y:i},{x:0,y:0},r[i][o]);for(var s=0;s<a.cells.length;s++)for(var c=0;c<a.cells[0].length;c++)a.cells[s][c]&&C(t,{x:c,y:s},a.origin,a.value,!1)},n.canvasRef=Object(a.createRef)(),n}return Object(l.a)(r,[{key:"render",value:function(){return n.a.createElement("canvas",{ref:this.canvasRef})}}]),r}(a.Component)),A=function(e){Object(u.a)(r,e);var t=Object(m.a)(r);function r(e){var a;return Object(c.a)(this,r),(a=t.call(this,e)).componentDidMount=function(){a.rAF=requestAnimationFrame(a.updateAnimationState)},a.shouldComponentUpdate=function(){return a.AnimationFlag},a.componentDidUpdate=function(){a.AnimationFlag=!1},a.updateAnimationState=function(){a.rAF=requestAnimationFrame(a.updateAnimationState),a.AnimationFlag=!0},a.componentWillUnmount=function(){cancelAnimationFrame(a.rAF)},a.render=function(){return n.a.createElement(T,a.props)},a.AnimationFlag=!1,a.lastUpdate=Date.now(),a}return r}(n.a.Component);function C(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:40,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];e.save(),e.scale(1*i,-1*i),o||e.translate(0,-20),e.translate(t.x+r.x,t.y+r.y);var s=n?-25:0;switch(a){case"I":e.fillStyle="hsl(192.7, "+(73.8+s)+"%, 68.7%)";break;case"J":e.fillStyle="hsl(217.2, "+(100+s)+"%, 36.7%)";break;case"L":e.fillStyle="hsl(38.3, "+(100+s)+"%, 50%)";break;case"S":e.fillStyle="hsl(111.5, "+(67.4+s)+"%, 50.6%)";break;case"Z":e.fillStyle="hsl(355.8, "+(85.4+s)+"%, 56.9%)";break;case"T":e.fillStyle="hsl(300, "+(64+s)+"%, 44.7%)";break;case"O":e.fillStyle="hsl(51.7, "+(100+s)+"%, 49.8%)";break;default:e.fillStyle="hsl(214.3, 4%, 33.9%)"}e.fillRect(0,0,1,1),e.lineWidth=~~(1/i),e.rect(0,0,1,1),e.restore(),e.stroke()}r(16),r(17);var j=function(e){return n.a.createElement("div",{className:"display"},e.isNewGame?"START":"GAME OVER",n.a.createElement("button",{className:"startButton",onClick:e.handleStartGame},">"))},D=function(e){Object(u.a)(r,e);var t=Object(m.a)(r);function r(e){var i;return Object(c.a)(this,r),(i=t.call(this,e)).initialState=function(){for(var e=Object(s.a)(Array(22)).map((function(){return Array(10)})),t=0;t<22;t++)for(var r=0;r<10;r++)e[t][r]=0;return{board:e,tetromino:i.createTetromino(),que:[i.createTetromino()],score:0,linesCleared:0}},i.componentDidMount=function(){i.canvas=i.canvasRef.current,i.ctx=i.canvas.getContext("2d")},i.gameOver=function(){i.setState({isDisplay:!0}),clearTimeout(i.timeOut)},i.createTetromino=function(){var e=[d,O,N,d,S,y,x,h];return e[Math.floor(Math.random()*e.length)]},i.lockTetromino=function(){var e=i.findPos(i.state.tetromino),t=JSON.parse(JSON.stringify(i.state.board));e.forEach((function(e){t[e.y][e.x]=i.state.tetromino.value})),i.setState({board:t})},i.clearLines=function(){var e=i.findPos(i.state.tetromino),t=Object(s.a)(new Set(e.map((function(e){return e.y})))).filter((function(e){return!i.state.board[e].includes(0)}));if(t.length){var r=Object(s.a)(i.state.board);t.sort();for(var a=t.length-1;a>=0;a--)r.splice(t[a],1),r.push(new Array(10).fill(0));var n=[40,100,300,1200][t.length-1]*(1+~~(i.state.linesCleared/10));i.setState((function(e){return{board:r,linesCleared:e.linesCleared+t.length,score:e.score+n}}))}},i.tetrominoBottomedOut=function(){i.lockTetromino(),i.clearLines();var e=E.levels.findIndex((function(e){return e>=Math.min(~~(i.state.linesCleared/10),29)})),t=E.speeds[e],r=JSON.parse(JSON.stringify(i.state.que[0])),a=i.spawnTetromino(r);i.checkCollision(a)?i.gameOver():(i.dropTime=t,i.setState((function(e){return{tetromino:a,que:[i.createTetromino()]}})),i.drawNextPiece())},i.nextDrop=function(){var e=JSON.parse(JSON.stringify(i.state.tetromino));e.origin.y--,i.checkCollision(e)?i.tetrominoBottomedOut():i.setState({tetromino:e}),i.state.isDisplay||i.resetTimeout()},i.checkCollision=function(e){var t=i.findPos(e),r=i.state.board;return t.some((function(e){return e.x>=10||e.x<0||e.y>=22||e.y<0||!!r[e.y][e.x]}))},i.resetTimeout=function(){clearTimeout(i.timeOut),i.timeOut=setTimeout(i.nextDrop,i.dropTime)},i.handleKeyPress=function(e){if(i.state.isDisplay)i.forceUpdate();else{var t=e.code,r=JSON.parse(JSON.stringify(i.state.tetromino)),a=!1;switch(t){case"ArrowLeft":r.origin.x--;break;case"ArrowRight":r.origin.x++;break;case"ArrowUp":var n={I:v,J:w,L:k,Z:g,S:p,T:f,O:b};r.orient=(r.orient+1)%4,r.cells=n[r.value][r.orient];break;case"ArrowDown":r.origin.y--,a=!0}var o=i.state.score;a&&(i.resetTimeout(),o++),i.checkCollision(r)?a&&i.tetrominoBottomedOut():i.setState((function(e){return{tetromino:r,score:o}}))}},i.handleStartGame=function(){i.reset()},i.drawNextPiece=function(){i.ctx.beginPath(),i.ctx.clearRect(0,0,i.canvas.width,i.canvas.height),i.ctx.save(),i.ctx.translate(-20,100);for(var e=i.state.que[0],t=0;t<e.cells.length;t++)for(var r=0;r<e.cells[0].length;r++)e.cells[t][r]&&C(i.ctx,{x:r,y:t},J(e.value),e.value,!1,40,!0);i.ctx.restore()},i.render=function(){return n.a.createElement("div",{className:"grid-container"},n.a.createElement("div",{className:"score"}," ","Score: ",n.a.createElement("span",{className:"value-text"}," ",i.state.score)),n.a.createElement(A,{board:i.state.board,tetromino:i.state.tetromino,handleKeyPress:i.handleKeyPress}),i.state.isDisplay&&n.a.createElement(j,{handleStartGame:i.handleStartGame,isNewGame:i.isNewGame}),n.a.createElement("div",{className:"flex-container"},n.a.createElement("div",{className:"next-piece"},"Next",n.a.createElement("div",{className:"next-piece-wrapper"},n.a.createElement("canvas",{className:"next-piece-canvas border-box",ref:i.canvasRef,width:200,height:160}))),n.a.createElement("div",{className:"level"},"Level",n.a.createElement("div",{className:"value-text"},~~(i.state.linesCleared/10))),n.a.createElement("div",{className:"lines-cleared"},"Lines",n.a.createElement("div",{className:"value-text"},i.state.linesCleared))))},i.state=i.initialState(),i.state.isDisplay=!0,i.canvasRef=Object(a.createRef)(),i.isNewGame=!0,i}return Object(l.a)(r,[{key:"reset",value:function(){var e=this;this.setState(this.initialState(),(function(){e.drawNextPiece()})),this.dropTime=E.speeds[0],this.resetTimeout(),this.isNewGame=!1,this.setState({isDisplay:!1})}},{key:"spawnTetromino",value:function(e){return this.checkCollision(e)&&e.origin.y++,e}},{key:"findPos",value:function(e){for(var t=e.cells,r=[],a=0;a<t.length;a++)for(var n=0;n<t[0].length;n++)t[a][n]&&r.push({x:n+e.origin.x,y:a+e.origin.y});return r}}]),r}(a.Component),J=function(e){var t;switch(e){case"I":t={x:1,y:-2.5};break;case"O":t={x:2,y:-1};break;case"J":case"L":case"S":case"Z":case"T":t={x:1.5,y:-2};break;default:t={x:0,y:0}}return t};var P=function(){return n.a.createElement("div",{className:"Game"},n.a.createElement(D,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[9,1,2]]]);
//# sourceMappingURL=main.d40b1b84.chunk.js.map