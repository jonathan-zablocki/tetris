(this["webpackJsonptetris-app"]=this["webpackJsonptetris-app"]||[]).push([[0],[,,,,,,,function(e,t,r){},,function(e,t,r){e.exports=r(19)},,,,,function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){},function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),s=r(8),o=r.n(s),i=(r(14),r(15),r(5)),c=r(1),l=r(4),u=r(3),m=r(2),v=[[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]].reverse(),[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]].reverse(),[[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]].reverse(),[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]].reverse()],d={value:"I",origin:{x:3,y:18},orient:0,cells:v[0]},f=[[[0,1,0],[1,1,1],[0,0,0]].reverse(),[[0,1,0],[0,1,1],[0,1,0]].reverse(),[[0,0,0],[1,1,1],[0,1,0]].reverse(),[[0,1,0],[1,1,0],[0,1,0]].reverse()],h={value:"T",origin:{x:3,y:19},orient:0,cells:f[0]},p=[[[0,1,1],[1,1,0],[0,0,0]].reverse(),[[0,1,0],[0,1,1],[0,0,1]].reverse(),[[0,0,0],[0,1,1],[1,1,0]].reverse(),[[1,0,0],[1,1,0],[0,1,0]].reverse()],S={value:"S",origin:{x:3,y:19},orient:0,cells:p[0]},y=[[[1,1,0],[0,1,1],[0,0,0]].reverse(),[[0,0,1],[0,1,1],[0,1,0]].reverse(),[[0,0,0],[1,1,0],[0,1,1]].reverse(),[[0,1,0],[1,1,0],[1,0,0]].reverse()],g={value:"Z",origin:{x:3,y:19},orient:0,cells:y[0]},b=[[[1,1],[1,1]].reverse(),[[1,1],[1,1]].reverse(),[[1,1],[1,1]].reverse(),[[1,1],[1,1]].reverse()],x={value:"O",origin:{x:4,y:20},orient:0,cells:b[0]},O=[[[1,0,0],[1,1,1],[0,0,0]].reverse(),[[0,1,1],[0,1,0],[0,1,0]].reverse(),[[0,0,0],[1,1,1],[0,0,1]].reverse(),[[0,1,0],[0,1,0],[1,1,0]].reverse()],E={value:"J",origin:{x:4,y:19},orient:0,cells:O[0]},w=[[[0,0,1],[1,1,1],[0,0,0]].reverse(),[[0,1,0],[0,1,0],[0,1,1]].reverse(),[[0,0,0],[1,1,1],[1,0,0]].reverse(),[[1,1,0],[0,1,0],[0,1,0]].reverse()],N={value:"L",origin:{x:4,y:19},orient:0,cells:w[0]},k={levels:[0,1,2,3,4,5,6,7,8,9,10,13,16,19,29],speeds:[800,717,633,550,467,383,300,217,133,100,83,67,50,33,17]},C=(r(7),function(e){Object(u.a)(r,e);var t=Object(m.a)(r);function r(e){var n;return Object(c.a)(this,r),(n=t.call(this,e)).componentDidMount=function(){document.addEventListener("keydown",n.props.handleKeyPress),n.drawBoard()},n.componentWillUnmount=function(){document.removeEventListener("keydown",n.props.handleKeyPress)},n.componentDidUpdate=function(){n.drawBoard()},n.drawBoard=function(){var e=n.canvasRef.current,t=e.getContext("2d"),r=n.props.board,a=n.props.tetromino;e.width=400,e.height=800;for(var s=0;s<20;s++)for(var o=0;o<10;o++)j(t,{x:o,y:s},{x:0,y:0},r[s][o]);for(var i=0;i<a.cells.length;i++)for(var c=0;c<a.cells[0].length;c++)a.cells[i][c]&&j(t,{x:c,y:i},a.origin,a.value,!1)},n.canvasRef=Object(a.createRef)(),n}return Object(l.a)(r,[{key:"render",value:function(){return n.a.createElement("canvas",{ref:this.canvasRef})}}]),r}(a.Component)),T=function(e){Object(u.a)(r,e);var t=Object(m.a)(r);function r(e){var a;return Object(c.a)(this,r),(a=t.call(this,e)).componentDidMount=function(){a.rAF=requestAnimationFrame(a.updateAnimationState)},a.shouldComponentUpdate=function(){return a.AnimationFlag},a.componentDidUpdate=function(){a.AnimationFlag=!1},a.updateAnimationState=function(){a.rAF=requestAnimationFrame(a.updateAnimationState),a.AnimationFlag=!0},a.componentWillUnmount=function(){cancelAnimationFrame(a.rAF)},a.render=function(){return n.a.createElement(C,a.props)},a.AnimationFlag=!1,a.lastUpdate=Date.now(),a}return r}(n.a.Component);function j(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:40,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];e.save(),e.scale(1*s,-1*s),o||e.translate(0,-20),e.translate(t.x+r.x,t.y+r.y);var i=n?-25:0;switch(a){case"I":e.fillStyle="hsl(192.7, "+(73.8+i)+"%, 68.7%)";break;case"J":e.fillStyle="hsl(217.2, "+(100+i)+"%, 36.7%)";break;case"L":e.fillStyle="hsl(38.3, "+(100+i)+"%, 50%)";break;case"S":e.fillStyle="hsl(111.5, "+(67.4+i)+"%, 50.6%)";break;case"Z":e.fillStyle="hsl(355.8, "+(85.4+i)+"%, 56.9%)";break;case"T":e.fillStyle="hsl(300, "+(64+i)+"%, 44.7%)";break;case"O":e.fillStyle="hsl(51.7, "+(100+i)+"%, 49.8%)";break;default:e.fillStyle="hsl(214.3, 4%, 33.9%)"}e.fillRect(0,0,1,1),e.lineWidth=~~(1/s),e.rect(0,0,1,1),e.restore(),e.stroke()}r(16),r(17);var A=function(e){return n.a.createElement("div",{className:"display"},e.isNewGame?"START":"GAME OVER",n.a.createElement("button",{className:"startButton",onClick:e.handleStartGame},">"),n.a.createElement("button",{className:"trophy",onClick:e.handleOpenScores},n.a.createElement("i",{className:"fa fa-trophy","aria-hidden":"true"})))},D=(r(18),function(e){Object(u.a)(r,e);var t=Object(m.a)(r);function r(e){var a;return Object(c.a)(this,r),(a=t.call(this,e)).render=function(){var e=n.a.createElement("button",{className:"closeScoresButton",onClick:a.props.handleCloseScores},"<");if(a.state.isLoading)return a.state.isServerSlow?n.a.createElement("div",{className:"scores"},"...Server is sleeping :( If you wait a minute it should wake up.",e):n.a.createElement("div",{className:"scores"},"Loading ... ",e);if(a.state.isError)return setTimeout((function(){a.props.handleCloseScores()}),5e3),n.a.createElement("div",{className:"scores"},n.a.createElement("center",null,"Could Not View High Scores"),e);var t=a.state.serverData.map((function(e){return e.score}));return console.log(a.props),n.a.createElement("div",{className:"scores"},n.a.createElement("div",{className:"title"},"High Scores"),n.a.createElement("div",{className:"scroll"},n.a.createElement("table",null,n.a.createElement("tbody",null,t.map((function(e,t){return n.a.createElement("tr",{key:t+1},n.a.createElement("td",{className:"position"},t+1),n.a.createElement("td",{className:"high-score"},e))}))))),e)},a.state={isLoading:!0,isError:!1,isServerSlow:!1},a}return Object(l.a)(r,[{key:"componentDidMount",value:function(){var e=this,t=setTimeout((function(){e.setState({isServerSlow:!0})}),15e3);fetch("https://tetris-backend-server.herokuapp.com/scores").then((function(e){return e.json()})).then((function(r){e.setState({serverData:r,isLoading:!1}),clearTimeout(t)})).catch((function(t){console.log(t),e.setState({isError:!0,isLoading:!1,isSeverSlow:!1})}))}}]),r}(a.Component)),L=function(e){Object(u.a)(r,e);var t=Object(m.a)(r);function r(e){var s;return Object(c.a)(this,r),(s=t.call(this,e)).initialState=function(){for(var e=Object(i.a)(Array(22)).map((function(){return Array(10)})),t=0;t<22;t++)for(var r=0;r<10;r++)e[t][r]=0;return{board:e,tetromino:s.createTetromino(),que:[s.createTetromino()],score:0,linesCleared:0}},s.componentDidMount=function(){s.canvas=s.canvasRef.current,s.ctx=s.canvas.getContext("2d"),fetch("https://tetris-backend-server.herokuapp.com/scores")},s.gameOver=function(){s.setState({isDisplay:!0}),clearTimeout(s.timeOut),s.submitScore()},s.submitScore=function(){var e={score:s.state.score};fetch("https://tetris-backend-server.herokuapp.com/scores",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})},s.createTetromino=function(){var e=[d,E,N,d,x,S,g,h];return e[Math.floor(Math.random()*e.length)]},s.lockTetromino=function(){var e=s.findPos(s.state.tetromino),t=JSON.parse(JSON.stringify(s.state.board));e.forEach((function(e){t[e.y][e.x]=s.state.tetromino.value})),s.setState({board:t})},s.clearLines=function(){var e=s.findPos(s.state.tetromino),t=Object(i.a)(new Set(e.map((function(e){return e.y})))).filter((function(e){return!s.state.board[e].includes(0)}));if(t.length){var r=Object(i.a)(s.state.board);t.sort();for(var a=t.length-1;a>=0;a--)r.splice(t[a],1),r.push(new Array(10).fill(0));var n=[40,100,300,1200][t.length-1]*(1+~~(s.state.linesCleared/10));s.setState((function(e){return{board:r,linesCleared:e.linesCleared+t.length,score:e.score+n}}))}},s.tetrominoBottomedOut=function(){s.lockTetromino(),s.clearLines();var e=k.levels.findIndex((function(e){return e>=Math.min(~~(s.state.linesCleared/10),29)})),t=k.speeds[e],r=JSON.parse(JSON.stringify(s.state.que[0])),a=s.spawnTetromino(r);s.checkCollision(a)?s.gameOver():(s.dropTime=t,s.setState((function(e){return{tetromino:a,que:[s.createTetromino()]}})),s.drawNextPiece())},s.nextDrop=function(){var e=JSON.parse(JSON.stringify(s.state.tetromino));e.origin.y--,s.checkCollision(e)?s.tetrominoBottomedOut():s.setState({tetromino:e}),s.state.isDisplay||s.resetTimeout()},s.checkCollision=function(e){var t=s.findPos(e),r=s.state.board;return t.some((function(e){return e.x>=10||e.x<0||e.y>=22||e.y<0||!!r[e.y][e.x]}))},s.resetTimeout=function(){clearTimeout(s.timeOut),s.timeOut=setTimeout(s.nextDrop,s.dropTime)},s.handleKeyPress=function(e){if(s.state.isDisplay)s.forceUpdate();else{var t=e.code,r=JSON.parse(JSON.stringify(s.state.tetromino)),a=!1;switch(t){case"ArrowLeft":r.origin.x--;break;case"ArrowRight":r.origin.x++;break;case"ArrowUp":var n={I:v,J:O,L:w,Z:y,S:p,T:f,O:b};r.orient=(r.orient+1)%4,r.cells=n[r.value][r.orient];break;case"ArrowDown":r.origin.y--,a=!0}var o=s.state.score;a&&(s.resetTimeout(),o++),s.checkCollision(r)?a&&s.tetrominoBottomedOut():s.setState((function(e){return{tetromino:r,score:o}}))}},s.handleStartGame=function(){s.reset()},s.handleOpenScores=function(){s.setState({isDisplay:!1,isScores:!0})},s.handleCloseScores=function(){s.setState({isDisplay:!0,isScores:!1})},s.drawNextPiece=function(){s.ctx.beginPath(),s.ctx.clearRect(0,0,s.canvas.width,s.canvas.height),s.ctx.save(),s.ctx.translate(-20,100);for(var e=s.state.que[0],t=0;t<e.cells.length;t++)for(var r=0;r<e.cells[0].length;r++)e.cells[t][r]&&j(s.ctx,{x:r,y:t},J(e.value),e.value,!1,40,!0);s.ctx.restore()},s.render=function(){return n.a.createElement("div",{className:"grid-container"},n.a.createElement("div",{className:"score"}," ","Score: ",n.a.createElement("span",{className:"value-text"}," ",s.state.score)),n.a.createElement(T,{board:s.state.board,tetromino:s.state.tetromino,handleKeyPress:s.handleKeyPress}),s.state.isDisplay&&n.a.createElement(A,{handleStartGame:s.handleStartGame,handleOpenScores:s.handleOpenScores,isNewGame:s.isNewGame}),s.state.isScores&&n.a.createElement(D,{handleCloseScores:s.handleCloseScores}),n.a.createElement("div",{className:"flex-container"},n.a.createElement("div",{className:"next-piece"},"Next",n.a.createElement("div",{className:"next-piece-wrapper"},n.a.createElement("canvas",{className:"next-piece-canvas border-box",ref:s.canvasRef,width:200,height:160}))),n.a.createElement("div",{className:"level"},"Level",n.a.createElement("div",{className:"value-text"},~~(s.state.linesCleared/10))),n.a.createElement("div",{className:"lines-cleared"},"Lines",n.a.createElement("div",{className:"value-text"},s.state.linesCleared))))},s.state=s.initialState(),s.state.isDisplay=!0,s.state.isScores=!1,s.canvasRef=Object(a.createRef)(),s.isNewGame=!0,s}return Object(l.a)(r,[{key:"reset",value:function(){var e=this;this.setState(this.initialState(),(function(){e.drawNextPiece()})),this.dropTime=k.speeds[0],this.resetTimeout(),this.isNewGame=!1,this.setState({isDisplay:!1})}},{key:"spawnTetromino",value:function(e){return this.checkCollision(e)&&e.origin.y++,e}},{key:"findPos",value:function(e){for(var t=e.cells,r=[],a=0;a<t.length;a++)for(var n=0;n<t[0].length;n++)t[a][n]&&r.push({x:n+e.origin.x,y:a+e.origin.y});return r}}]),r}(a.Component),J=function(e){var t;switch(e){case"I":t={x:1,y:-2.5};break;case"O":t={x:2,y:-1};break;case"J":case"L":case"S":case"Z":case"T":t={x:1.5,y:-2};break;default:t={x:0,y:0}}return t};var P=function(){return n.a.createElement("div",{className:"Game"},n.a.createElement(L,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[9,1,2]]]);
//# sourceMappingURL=main.f99f2700.chunk.js.map