(this["webpackJsonptetris-app"]=this["webpackJsonptetris-app"]||[]).push([[0],[,,,,,,,function(e,t,a){},,function(e,t,a){e.exports=a(19)},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(8),s=a.n(o),i=(a(14),a(15),a(5)),c=a(1),l=a(4),u=a(3),m=a(2),d=[[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]].reverse(),[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]].reverse(),[[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]].reverse(),[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]].reverse()],v={value:"I",origin:{x:3,y:18},orient:0,cells:d[0]},f=[[[0,1,0],[1,1,1],[0,0,0]].reverse(),[[0,1,0],[0,1,1],[0,1,0]].reverse(),[[0,0,0],[1,1,1],[0,1,0]].reverse(),[[0,1,0],[1,1,0],[0,1,0]].reverse()],h={value:"T",origin:{x:3,y:19},orient:0,cells:f[0]},p=[[[0,1,1],[1,1,0],[0,0,0]].reverse(),[[0,1,0],[0,1,1],[0,0,1]].reverse(),[[0,0,0],[0,1,1],[1,1,0]].reverse(),[[1,0,0],[1,1,0],[0,1,0]].reverse()],y={value:"S",origin:{x:3,y:19},orient:0,cells:p[0]},S=[[[1,1,0],[0,1,1],[0,0,0]].reverse(),[[0,0,1],[0,1,1],[0,1,0]].reverse(),[[0,0,0],[1,1,0],[0,1,1]].reverse(),[[0,1,0],[1,1,0],[1,0,0]].reverse()],g={value:"Z",origin:{x:3,y:19},orient:0,cells:S[0]},b=[[[1,1],[1,1]].reverse(),[[1,1],[1,1]].reverse(),[[1,1],[1,1]].reverse(),[[1,1],[1,1]].reverse()],x={value:"O",origin:{x:4,y:20},orient:0,cells:b[0]},O=[[[1,0,0],[1,1,1],[0,0,0]].reverse(),[[0,1,1],[0,1,0],[0,1,0]].reverse(),[[0,0,0],[1,1,1],[0,0,1]].reverse(),[[0,1,0],[0,1,0],[1,1,0]].reverse()],E={value:"J",origin:{x:4,y:19},orient:0,cells:O[0]},N=[[[0,0,1],[1,1,1],[0,0,0]].reverse(),[[0,1,0],[0,1,0],[0,1,1]].reverse(),[[0,0,0],[1,1,1],[1,0,0]].reverse(),[[1,1,0],[0,1,0],[0,1,0]].reverse()],k={value:"L",origin:{x:4,y:19},orient:0,cells:N[0]},w={levels:[0,1,2,3,4,5,6,7,8,9,10,13,16,19,29],speeds:[800,717,633,550,467,383,300,217,133,100,83,67,50,33,17]},C=(a(7),function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){document.addEventListener("keydown",n.props.handleKeyPress),n.drawBoard()},n.componentWillUnmount=function(){document.removeEventListener("keydown",n.props.handleKeyPress)},n.componentDidUpdate=function(){n.drawBoard()},n.drawBoard=function(){var e=n.canvasRef.current,t=e.getContext("2d"),a=n.props.board,r=n.props.tetromino;e.width=400,e.height=800;for(var o=0;o<20;o++)for(var s=0;s<10;s++)j(t,{x:s,y:o},{x:0,y:0},a[o][s]);for(var i=0;i<r.cells.length;i++)for(var c=0;c<r.cells[0].length;c++)r.cells[i][c]&&j(t,{x:c,y:i},r.origin,r.value,!1)},n.canvasRef=Object(r.createRef)(),n}return Object(l.a)(a,[{key:"render",value:function(){return n.a.createElement("canvas",{ref:this.canvasRef})}}]),a}(r.Component)),T=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).componentDidMount=function(){r.rAF=requestAnimationFrame(r.updateAnimationState)},r.shouldComponentUpdate=function(){return r.AnimationFlag},r.componentDidUpdate=function(){r.AnimationFlag=!1},r.updateAnimationState=function(){r.rAF=requestAnimationFrame(r.updateAnimationState),r.AnimationFlag=!0},r.componentWillUnmount=function(){cancelAnimationFrame(r.rAF)},r.render=function(){return n.a.createElement(C,r.props)},r.AnimationFlag=!1,r.lastUpdate=Date.now(),r}return a}(n.a.Component);function j(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:40,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];e.save(),e.scale(1*o,-1*o),s||e.translate(0,-20),e.translate(t.x+a.x,t.y+a.y);var i=n?-25:0;switch(r){case"I":e.fillStyle="hsl(192.7, "+(73.8+i)+"%, 68.7%)";break;case"J":e.fillStyle="hsl(217.2, "+(100+i)+"%, 36.7%)";break;case"L":e.fillStyle="hsl(38.3, "+(100+i)+"%, 50%)";break;case"S":e.fillStyle="hsl(111.5, "+(67.4+i)+"%, 50.6%)";break;case"Z":e.fillStyle="hsl(355.8, "+(85.4+i)+"%, 56.9%)";break;case"T":e.fillStyle="hsl(300, "+(64+i)+"%, 44.7%)";break;case"O":e.fillStyle="hsl(51.7, "+(100+i)+"%, 49.8%)";break;default:e.fillStyle="hsl(214.3, 4%, 33.9%)"}e.fillRect(0,0,1,1),e.lineWidth=~~(1/o),e.rect(0,0,1,1),e.restore(),e.stroke()}a(16),a(17);var A=function(e){return n.a.createElement("div",{className:"display"},e.isNewGame?"START":"GAME OVER",n.a.createElement("button",{className:"startButton",onClick:e.handleStartGame},">"),n.a.createElement("button",{className:"trophy",onClick:e.handleOpenScores},n.a.createElement("i",{className:"fa fa-trophy","aria-hidden":"true"})))},D=(a(18),function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).render=function(){if(r.state.isLoading)return n.a.createElement("div",{className:"scores"},"Loading ...");if(r.state.isError)return setTimeout((function(){r.props.handleCloseScores()}),3e3),n.a.createElement("div",{className:"scores"},n.a.createElement("center",null,"Could Not View High Scores"));var e=r.state.serverData.map((function(e){return e.score}));return console.log(r.props),n.a.createElement("div",{className:"scores"},n.a.createElement("div",{className:"title"},"High Scores"),n.a.createElement("div",{className:"scroll"},n.a.createElement("table",null,n.a.createElement("tbody",null,e.map((function(e,t){return n.a.createElement("tr",{key:t+1},n.a.createElement("td",{className:"position"},t+1),n.a.createElement("td",{className:"high-score"},e))}))))),n.a.createElement("button",{className:"closeScoresButton",onClick:r.props.handleCloseScores},"<"))},r.state={isLoading:!0,isError:!1},r}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("https://tetris-backend-server.herokuapp.com/scores").then((function(e){return e.json()})).then((function(t){e.setState({serverData:t,isLoading:!1})})).catch((function(t){console.log(t),e.setState({isError:!0,isLoading:!1})}))}}]),a}(r.Component)),L=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var o;return Object(c.a)(this,a),(o=t.call(this,e)).initialState=function(){for(var e=Object(i.a)(Array(22)).map((function(){return Array(10)})),t=0;t<22;t++)for(var a=0;a<10;a++)e[t][a]=0;return{board:e,tetromino:o.createTetromino(),que:[o.createTetromino()],score:0,linesCleared:0}},o.componentDidMount=function(){o.canvas=o.canvasRef.current,o.ctx=o.canvas.getContext("2d")},o.gameOver=function(){o.setState({isDisplay:!0}),clearTimeout(o.timeOut),o.submitScore()},o.submitScore=function(){var e={score:o.state.score};fetch("https://tetris-backend-server.herokuapp.com/scores",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})},o.createTetromino=function(){var e=[v,E,k,v,x,y,g,h];return e[Math.floor(Math.random()*e.length)]},o.lockTetromino=function(){var e=o.findPos(o.state.tetromino),t=JSON.parse(JSON.stringify(o.state.board));e.forEach((function(e){t[e.y][e.x]=o.state.tetromino.value})),o.setState({board:t})},o.clearLines=function(){var e=o.findPos(o.state.tetromino),t=Object(i.a)(new Set(e.map((function(e){return e.y})))).filter((function(e){return!o.state.board[e].includes(0)}));if(t.length){var a=Object(i.a)(o.state.board);t.sort();for(var r=t.length-1;r>=0;r--)a.splice(t[r],1),a.push(new Array(10).fill(0));var n=[40,100,300,1200][t.length-1]*(1+~~(o.state.linesCleared/10));o.setState((function(e){return{board:a,linesCleared:e.linesCleared+t.length,score:e.score+n}}))}},o.tetrominoBottomedOut=function(){o.lockTetromino(),o.clearLines();var e=w.levels.findIndex((function(e){return e>=Math.min(~~(o.state.linesCleared/10),29)})),t=w.speeds[e],a=JSON.parse(JSON.stringify(o.state.que[0])),r=o.spawnTetromino(a);o.checkCollision(r)?o.gameOver():(o.dropTime=t,o.setState((function(e){return{tetromino:r,que:[o.createTetromino()]}})),o.drawNextPiece())},o.nextDrop=function(){var e=JSON.parse(JSON.stringify(o.state.tetromino));e.origin.y--,o.checkCollision(e)?o.tetrominoBottomedOut():o.setState({tetromino:e}),o.state.isDisplay||o.resetTimeout()},o.checkCollision=function(e){var t=o.findPos(e),a=o.state.board;return t.some((function(e){return e.x>=10||e.x<0||e.y>=22||e.y<0||!!a[e.y][e.x]}))},o.resetTimeout=function(){clearTimeout(o.timeOut),o.timeOut=setTimeout(o.nextDrop,o.dropTime)},o.handleKeyPress=function(e){if(o.state.isDisplay)o.forceUpdate();else{var t=e.code,a=JSON.parse(JSON.stringify(o.state.tetromino)),r=!1;switch(t){case"ArrowLeft":a.origin.x--;break;case"ArrowRight":a.origin.x++;break;case"ArrowUp":var n={I:d,J:O,L:N,Z:S,S:p,T:f,O:b};a.orient=(a.orient+1)%4,a.cells=n[a.value][a.orient];break;case"ArrowDown":a.origin.y--,r=!0}var s=o.state.score;r&&(o.resetTimeout(),s++),o.checkCollision(a)?r&&o.tetrominoBottomedOut():o.setState((function(e){return{tetromino:a,score:s}}))}},o.handleStartGame=function(){o.reset()},o.handleOpenScores=function(){o.setState({isDisplay:!1,isScores:!0})},o.handleCloseScores=function(){o.setState({isDisplay:!0,isScores:!1})},o.drawNextPiece=function(){o.ctx.beginPath(),o.ctx.clearRect(0,0,o.canvas.width,o.canvas.height),o.ctx.save(),o.ctx.translate(-20,100);for(var e=o.state.que[0],t=0;t<e.cells.length;t++)for(var a=0;a<e.cells[0].length;a++)e.cells[t][a]&&j(o.ctx,{x:a,y:t},J(e.value),e.value,!1,40,!0);o.ctx.restore()},o.render=function(){return n.a.createElement("div",{className:"grid-container"},n.a.createElement("div",{className:"score"}," ","Score: ",n.a.createElement("span",{className:"value-text"}," ",o.state.score)),n.a.createElement(T,{board:o.state.board,tetromino:o.state.tetromino,handleKeyPress:o.handleKeyPress}),o.state.isDisplay&&n.a.createElement(A,{handleStartGame:o.handleStartGame,handleOpenScores:o.handleOpenScores,isNewGame:o.isNewGame}),o.state.isScores&&n.a.createElement(D,{handleCloseScores:o.handleCloseScores}),n.a.createElement("div",{className:"flex-container"},n.a.createElement("div",{className:"next-piece"},"Next",n.a.createElement("div",{className:"next-piece-wrapper"},n.a.createElement("canvas",{className:"next-piece-canvas border-box",ref:o.canvasRef,width:200,height:160}))),n.a.createElement("div",{className:"level"},"Level",n.a.createElement("div",{className:"value-text"},~~(o.state.linesCleared/10))),n.a.createElement("div",{className:"lines-cleared"},"Lines",n.a.createElement("div",{className:"value-text"},o.state.linesCleared))))},o.state=o.initialState(),o.state.isDisplay=!0,o.state.isScores=!1,o.canvasRef=Object(r.createRef)(),o.isNewGame=!0,o}return Object(l.a)(a,[{key:"reset",value:function(){var e=this;this.setState(this.initialState(),(function(){e.drawNextPiece()})),this.dropTime=w.speeds[0],this.resetTimeout(),this.isNewGame=!1,this.setState({isDisplay:!1})}},{key:"spawnTetromino",value:function(e){return this.checkCollision(e)&&e.origin.y++,e}},{key:"findPos",value:function(e){for(var t=e.cells,a=[],r=0;r<t.length;r++)for(var n=0;n<t[0].length;n++)t[r][n]&&a.push({x:n+e.origin.x,y:r+e.origin.y});return a}}]),a}(r.Component),J=function(e){var t;switch(e){case"I":t={x:1,y:-2.5};break;case"O":t={x:2,y:-1};break;case"J":case"L":case"S":case"Z":case"T":t={x:1.5,y:-2};break;default:t={x:0,y:0}}return t};var P=function(){return n.a.createElement("div",{className:"Game"},n.a.createElement(L,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[9,1,2]]]);
//# sourceMappingURL=main.c8530c2b.chunk.js.map